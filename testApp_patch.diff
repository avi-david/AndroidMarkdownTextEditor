From cd84cdbf5f3386545e2540a659504090e3d9512a Mon Sep 17 00:00:00 2001
From: Avinash David <adavid@fanreact.com>
Date: Wed, 8 Aug 2018 09:36:36 -0500
Subject: [PATCH] added test activity for fragment

---
 app/build.gradle                                   |  7 ++-
 app/src/main/AndroidManifest.xml                   | 23 ++++++--
 .../MarkdownTextEditorActivity.kt                  |  5 ++
 .../markdowntexteditor/TestActivity.kt             | 42 +++++++++++++
 app/src/main/res/layout/activity_test.xml          | 68 ++++++++++++++++++++++
 5 files changed, 138 insertions(+), 7 deletions(-)
 create mode 100644 app/src/main/java/com/avinashdavid/markdowntexteditor/TestActivity.kt
 create mode 100644 app/src/main/res/layout/activity_test.xml

diff --git a/app/build.gradle b/app/build.gradle
index b8a8ae1..b3084e0 100644
--- a/app/build.gradle
+++ b/app/build.gradle
@@ -1,4 +1,4 @@
-apply plugin: 'com.android.library'
+apply plugin: 'com.android.application'
 
 apply plugin: 'kotlin-android'
 
@@ -6,11 +6,12 @@ apply plugin: 'kotlin-android-extensions'
 
 apply plugin: 'android-maven'
 
-group='com.github.avi-david'
+group = 'com.github.avi-david'
 
 android {
     compileSdkVersion 28
     defaultConfig {
+        applicationId "com.avinashdavid.richtexteditor"
         minSdkVersion 19
         targetSdkVersion 28
         versionCode 1
@@ -27,7 +28,7 @@ android {
 
 dependencies {
     implementation fileTree(dir: 'libs', include: ['*.jar'])
-    implementation"org.jetbrains.kotlin:kotlin-stdlib-jre7:$kotlin_version"
+    implementation "org.jetbrains.kotlin:kotlin-stdlib-jre7:$kotlin_version"
     implementation 'com.android.support:appcompat-v7:28.0.0-beta01'
     implementation 'com.android.support.constraint:constraint-layout:1.1.2'
     implementation 'ru.noties:markwon:1.0.3'
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
index c434f74..ea13910 100644
--- a/app/src/main/AndroidManifest.xml
+++ b/app/src/main/AndroidManifest.xml
@@ -2,12 +2,27 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="com.avinashdavid.markdowntexteditor">
 
-    <application>
-        <activity android:name="com.avinashdavid.markdowntexteditor.MarkdownTextEditorActivity"
+    <application
+        android:allowBackup="true"
+        android:icon="@mipmap/ic_launcher"
+        android:label="@string/markdown_text_editor_app_name"
+        android:roundIcon="@mipmap/ic_launcher_round"
+        android:supportsRtl="true"
+        android:theme="@style/MarkdownTextEditor.AppTheme">
+        <activity
+            android:name=".MarkdownTextEditorActivity"
             android:label="@string/markdown_text_editor_app_name"
-            android:theme="@style/MarkdownTextEditor.AppTheme"
             android:screenOrientation="portrait"
-            android:windowSoftInputMode="adjustResize" />
+            android:theme="@style/MarkdownTextEditor.AppTheme"
+            android:windowSoftInputMode="adjustResize">
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN" />
+
+                <category android:name="android.intent.category.LAUNCHER" />
+            </intent-filter>
+        </activity>
+        <activity android:name=".TestActivity"
+            android:windowSoftInputMode="adjustResize"></activity>
     </application>
 
 </manifest>
\ No newline at end of file
diff --git a/app/src/main/java/com/avinashdavid/markdowntexteditor/MarkdownTextEditorActivity.kt b/app/src/main/java/com/avinashdavid/markdowntexteditor/MarkdownTextEditorActivity.kt
index 0192662..c4b9efa 100644
--- a/app/src/main/java/com/avinashdavid/markdowntexteditor/MarkdownTextEditorActivity.kt
+++ b/app/src/main/java/com/avinashdavid/markdowntexteditor/MarkdownTextEditorActivity.kt
@@ -133,6 +133,11 @@ open class MarkdownTextEditorActivity : AppCompatActivity() {
         etPrimaryEditor.setText(startingText)
     }
 
+    override fun onStart() {
+        super.onStart()
+        startActivity(Intent(this, TestActivity::class.java))
+    }
+
     override fun onSaveInstanceState(outState: Bundle?) {
         outState?.apply {
             putString(EXTRA_STARTING_TEXT, etPrimaryEditor.text.toString())
diff --git a/app/src/main/java/com/avinashdavid/markdowntexteditor/TestActivity.kt b/app/src/main/java/com/avinashdavid/markdowntexteditor/TestActivity.kt
new file mode 100644
index 0000000..743517e
--- /dev/null
+++ b/app/src/main/java/com/avinashdavid/markdowntexteditor/TestActivity.kt
@@ -0,0 +1,42 @@
+package com.avinashdavid.markdowntexteditor
+
+import android.support.v7.app.AppCompatActivity
+import android.os.Bundle
+import android.view.Menu
+import android.view.MenuItem
+import kotlinx.android.synthetic.main.activity_test.*
+import ru.noties.markwon.Markwon
+
+class TestActivity : AppCompatActivity(), MarkdownTextEditorFragment.IMarkdownTextEditorListener {
+    override fun onMarkdownTextEditingCompleted(markdown: String) {
+        etStartingText.setText(markdown)
+        Markwon.setMarkdown(tvResultTextView, markdown)
+    }
+
+    override fun onCreate(savedInstanceState: Bundle?) {
+        super.onCreate(savedInstanceState)
+        setContentView(R.layout.activity_test)
+        setSupportActionBar(toolbar)
+        btLaunchFragment.setOnClickListener {
+            launchFragmentWithText(etStartingText.text.toString())
+        }
+        supportFragmentManager.findFragmentByTag(MarkdownTextEditorFragment.FRAGMENT_TAG)?.let {
+            (it as MarkdownTextEditorFragment).setMarkdownTextListener(this)
+        }
+    }
+
+    private fun launchFragmentWithText(string: String?) {
+        val fragment = MarkdownTextEditorFragment.newInstance(this, string)
+        supportFragmentManager.beginTransaction()
+                .replace(R.id.flFragmentContainer, fragment, MarkdownTextEditorFragment.FRAGMENT_TAG)
+                .commit()
+    }
+
+    override fun onCreateOptionsMenu(menu: Menu?): Boolean {
+        return super.onCreateOptionsMenu(menu)
+    }
+
+    override fun onOptionsItemSelected(item: MenuItem?): Boolean {
+        return super.onOptionsItemSelected(item)
+    }
+}
diff --git a/app/src/main/res/layout/activity_test.xml b/app/src/main/res/layout/activity_test.xml
new file mode 100644
index 0000000..bb884e5
--- /dev/null
+++ b/app/src/main/res/layout/activity_test.xml
@@ -0,0 +1,68 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:orientation="vertical">
+    <android.support.v7.widget.Toolbar
+        android:id="@+id/toolbar"
+        android:layout_width="match_parent"
+        android:layout_height="64dp"/>
+    <FrameLayout
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        android:layout_weight="1"
+        tools:context="com.avinashdavid.markdowntexteditor.TestActivity">
+
+        <android.support.constraint.ConstraintLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent">
+
+            <EditText
+                android:id="@+id/etStartingText"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:hint="Enter starting text here"
+                app:layout_constraintTop_toTopOf="parent"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintRight_toRightOf="parent" />
+
+            <Button
+                android:id="@+id/btLaunchFragment"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Launch Fragment"
+                app:layout_constraintTop_toBottomOf="@+id/etStartingText"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintRight_toRightOf="parent" />
+
+            <TextView
+                android:id="@+id/tvResultLabel"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Result Text"
+                style="@style/Base.TextAppearance.AppCompat.Title"
+                app:layout_constraintTop_toBottomOf="@+id/btLaunchFragment"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintRight_toRightOf="parent" />
+
+            <TextView
+                android:id="@+id/tvResultTextView"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                app:layout_constraintTop_toBottomOf="@+id/tvResultLabel"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintRight_toRightOf="parent" />
+
+        </android.support.constraint.ConstraintLayout>
+
+        <FrameLayout
+            android:id="@+id/flFragmentContainer"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"/>
+
+    </FrameLayout>
+</LinearLayout>
+
-- 
2.10.1

